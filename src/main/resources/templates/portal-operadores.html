<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal de Operadores</title>
    <link rel="stylesheet" href="css/portales.css">
</head>
<body>
<header>
    <div class="container">
        <div class="logo">
            <img src="/img/logo.png" alt="Energía Inteligente">
        </div>
        <button onclick="cerrarSesion()">CERRAR SESIÓN</button>
    </div>
</header>

<section class="welcome-section">
    <div class="container">
        <h2>Bienvenido(a) al Portal de Operadores</h2>
        <p id="nombreOperador"></p>
    </div>
</section>

<section>
    <div class="container">
        <div class="menu">
            <ul>
                <li class="active">Menu</li>
                <li>Incidencias</li>
                <li>Alertas</li>
                <li>Mapa</li>
                <li>Facturación</li>
                <li>Clientes</li>
                <li>Empleados</li>
            </ul>
        </div>

        <div class="content-area">
            <div class="empty-message">Seleccione una opción del menú</div>

            <!-- INCIDENCIAS -->
            <div class="content" id="incidencias">
                <h2>Gestión de Incidencias</h2>
                <form id="incidencia-form">
                    <label>ID:</label>
                    <input type="text" class="form-control" placeholder="ID de la incidencia">
                    <label>Tipo:</label>
                    <select class="form-control">
                        <option>Técnica</option>
                        <option>Comercial</option>
                        <option>Seguridad</option>
                    </select>
                    <label>Descripción:</label>
                    <textarea class="form-control" rows="3"></textarea>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </form>
            </div>

            <!-- ALERTAS -->
            <div class="content" id="alertas">
                <h2>Gestión de Alertas</h2>
                <p>Contenido de alertas (por implementar).</p>
            </div>

            <!-- MAPA -->
            <div class="content" id="mapa">
                <h2>Mapa de Operaciones</h2>
                <div style="height: 300px; background-color: #eee; text-align: center; padding: 100px;">
                    Mapa interactivo (próximamente)
                </div>
            </div>

            <!-- FACTURACIÓN -->
            <div class="content" id="facturacion">
                <h2>Gestión de Facturación</h2>
                <form id="factura-form">
                    <label>ID:</label>
                    <input type="text" class="form-control" placeholder="ID de la factura">
                    <label>Cliente:</label>
                    <input type="text" class="form-control" placeholder="Nombre del cliente">
                    <label>Periodo:</label>
                    <input type="month" class="form-control">
                    <label>Monto:</label>
                    <input type="number" class="form-control">
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </form>
            </div>

            <!-- CLIENTES -->
            <div class="content" id="clientes">
                <h2>Gestión de Clientes</h2>
                <form id="cliente-form">
                    <label>Nombre:</label>
                    <input type="text" name="nombre" class="form-control" required>
                    <label>Correo:</label>
                    <input type="email" name="correo" class="form-control" required>
                    <label>Teléfono:</label>
                    <input type="tel" name="celular" class="form-control">
                    <label>Número de cuenta:</label>
                    <input type="text" name="numeroCuenta" class="form-control" required>
                    <label>Dirección:</label>
                    <input type="text" name="direccion" class="form-control">
                    <button type="submit" class="btn btn-primary">Guardar Cliente</button>
                </form>
            </div>

            <!-- EMPLEADOS -->
            <div class="content" id="empleados">
                <h2>Gestión de Empleados</h2>
                <form id="empleado-form">
                    <label>Cédula:</label>
                    <input type="text" name="cedula" class="form-control" required>
                    <label>Usuario:</label>
                    <input type="text" name="usuario" class="form-control" required>
                    <label>Contraseña:</label>
                    <input type="password" name="contrasena" class="form-control" required>
                    <label>Nombre:</label>
                    <input type="text" name="nombre" class="form-control">
                    <label>Área Encargada:</label>
                    <input type="text" name="areaEncargada" class="form-control">
                    <button type="submit" class="btn btn-primary">Guardar Empleado</button>
                </form>
            </div>
        </div>
    </div>
</section>

<footer>
    <div class="container">
        <p>&copy; 2025 Energía Inteligente</p>
    </div>
</footer>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const menuItems = document.querySelectorAll('.menu ul li');
        const contents = document.querySelectorAll('.content');
        const emptyMessage = document.querySelector('.empty-message');

        menuItems.forEach(item => {
            item.addEventListener('click', function() {
                menuItems.forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                contents.forEach(c => c.classList.remove('active'));

                if(this.textContent === 'Menu') {
                    emptyMessage.style.display = 'block';
                } else {
                    emptyMessage.style.display = 'none';
                    const contentId = this.textContent.toLowerCase().replace(/\s+/g, '-').normalize("NFD").replace(/[̀-ͯ]/g, "");
                    const target = document.getElementById(contentId);
                    if (target) target.classList.add('active');
                }
            });
        });

        // Crear Cliente
        document.getElementById('cliente-form').addEventListener('submit', e => {
            e.preventDefault();
            const data = Object.fromEntries(new FormData(e.target));
            fetch("http://localhost:8080/api/admin/clientes", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            }).then(res => res.ok && alert("Cliente guardado correctamente"));
        });

        // Crear Empleado
        document.getElementById('empleado-form').addEventListener('submit', e => {
            e.preventDefault();
            const data = Object.fromEntries(new FormData(e.target));
            fetch("http://localhost:8080/api/admin/empleados", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            }).then(res => res.ok && alert("Empleado guardado correctamente"));
        });

        // Simular Incidencia y Factura
        document.getElementById('factura-form').addEventListener('submit', e => {
            e.preventDefault();
            alert('Factura guardada (simulación)');
        });

        document.getElementById('incidencia-form').addEventListener('submit', e => {
            e.preventDefault();
            alert('Incidencia guardada (simulación)');
        });
    });

    function cerrarSesion() {
        window.location.href = "/";
    }
</script>
</body>
</html>
